cat("Tabla de Frecuencia Generada por consulta\n")
cat("=========================================\n")
tabrelfreq <- table(nrelfreq$Clases, nrelfreq$Financiacion, dnn = c("Clases","Financiacion"))
cat("\n")
cat("Creacion tabla frecuencia en orden\n")
cat("==================================\n")
tabblfreq<-table(tabrelfreq)
tabblfreq
cat("\n")
cat("I Construya una tabla de frecuencia o tabla de contingencia con  Financiacion y Clase\n")
cat("=======================================================================================\n")
table(nrelfreq$Financiacion) #tabla de frecuencia para Financiacion
cat("\n")
cat("I.I Tabla de frecuencia por clases\n")
cat("==================================\n")
table(nrelfreq$Clases) #tabla de frecuencia para Clases
cat("\n")
cat("I.II Tabla de contingencia entre Financiacion y Clases\n")
cat("=========================================================")
table(nrelfreq$Financiacion, nrelfreq$Clases) #tabla de contingencia entre Financiacion y Clases
# Valores que se obtuvieron en las tablas
P2_2<-54/(285+115)
cat('Resultado de elegir un estudiante al azar es :', P2_2)
P2_3<-81/285
cat("La Probabilidad que tenga beca es : ",P2_3)
P4_B<-0.36*0.02+0.31*0.03+0.33*0.05
cat("La Probabilidad que tenga problema con el pago es : ",P4_B)
P4_C<-(0.33*0.05)/P4_B
cat("La Probabilidad que tenga beca con el problema del pago es : ",P4_C)
prop.table(table(Estud$Fuma))*100
DEstudents <- read_csv("DEstudents.csv",
col_types = cols(Estrato = col_character()))
p<-as.numeric(count(DEstudents[DEstudents$Fuma == "Si", "Fuma"])/count(DEstudents[DEstudents$Fuma, "Fuma"]))
n<-25
k<-10
#dbinom(k,n,p)
cat("La Probabilidad que 10 ellos si fuma es : ",dbinom(k,n,p))
n<-30
k<-15
#pbinom(k, n, p)
cat("La Probabilidad  que a lo más 15 de ellos si fuma es : ",pbinom(k, n, p))
E<-round(n*(1-p))
cat("El número esperado de estudiante que no fuma es :",E, " Alumnos" )
s <- DEstudents %>%
summarize(media = mean(DEstudents$Ingreso), deviacion_standar = sd(DEstudents$Ingreso))
s
pn<-pnorm(1.5,mean(DEstudents$Ingreso),sd(DEstudents$Ingreso))
cat("La probabilidad de que el ingreso sea a lo más de $1.500.000 es: ", pn)
pi<-1-pnorm(1,mean(DEstudents$Ingreso),sd(DEstudents$Ingreso))
cat("probabilidad de que el ingreso sea de más de $1.000.000 es:",pi)
if(!require(knitr)) { install.packages("knitr"); library(knitr) } # trabajos proyecto y tablas
if(!require(readxl)) { install.packages("readxl"); library(readxl) } # lectura de archivo xlsx
if(!require(stringr)) { install.packages("stringr"); library(stringr) } # reconocimientos strigr
if(!require(readr)) { install.packages("readr"); library(readr) } # lectura de documento csv
if(!require(dplyr)) { install.packages("readr"); library(dplyr) } # paquete consulta tablas
if(!require(kableExtra)) { install.packages("kableExtra"); library(kableExtra) } # librería  de tablas
if(!require(ggplot2)) { install.packages("ggplot2"); library(ggplot2) } #paquetes de gráficos
if(!require(GGally)) { install.packages("GGally"); library(GGally) } # libreria para gráficos
if(!require(PerformanceAnalytics)) { install.packages("PerformanceAnalytics"); library(PerformanceAnalytics) }
library(knitr)
library(RColorBrewer)
library(ggplot2)
library(proto)
library(dplyr)
library(kableExtra)
library(readr)
library(readxl)
library(GGally)
library(RColorBrewer) # colores de gráficos
library(PerformanceAnalytics)
# carga de la datasets Estudiantes
Estud <- read_excel("C:/Users/salop/OneDrive/Escritorio/EnvR/MagisterUdla/AnalisisEstadistico_Viviam_Salomon/Estudiantes.xlsx") #cargamos la data xlsx
Estud<-Estud[100:249,] #cantidad seleccionada para la muestra es 150 datos
Estud<-data.frame(Estud) # la convertimos en dataframe
Estudi<-Estud[,c("ID","Sexo","Edad","Fuma","Estatura","Colegio","Estrato")] # seleccionamos las tablas
head(Estudi,3) %>%
kable(booktabs = TRUE,format = "latex", caption = "\\label{tabla2}Presentación Primera Mitad tabla Actual a Trabajar") %>%
kable_styling( latex_options = c("striped", "condensed","hold_position","scale_down"), position="left")
Estudi2<-Estud[,c("Financiacion","Acumulado","Gastos","Ingreso","Clases","Pandemia")] #selección de campos
head(Estudi2,3) %>%
kable(booktabs = TRUE,format = "latex", caption = "\\label{tabla3}Presentación Segunda Mitad tabla Actual a Trabajar") %>%
kable_styling( latex_options = c("striped", "condensed","hold_position","scale_down"), position="left")
Estudi3<-Estud[,c("Clases_virtuales","Estadistica","inseguridad","vida_cotidiana","Puntaje")]
head(Estudi3,6) %>%
kable(booktabs = TRUE,format = "latex", caption = "\\label{tabla4}Presentación Tercera Mitad tabla Actual a Trabajar") %>%
kable_styling( latex_options = c("striped", "condensed","hold_position","scale_down"), position="left")
apply(X = is.na(Estud), MARGIN = 2, FUN = sum)
Estudiuni<-Estud[,c("ID","Sexo","Edad","Fuma","Estatura","Colegio","Estrato","Financiacion","Acumulado","Gastos")]
Estudiuni %>% summarise_all(funs(n_distinct(.))) %>%
kable(booktabs = TRUE,format = "latex", caption = "\\label{tabla5}Presentación valores unicos de la tabla original priemra parte") %>%
kable_styling( latex_options = c("striped", "condensed","hold_position","scale_down"), position="left")
Estudiuni2<-Estud[,c("Ingreso","Clases","Pandemia","Clases_virtuales","Estadistica","inseguridad","vida_cotidiana","Puntaje")]
Estudiuni2 %>% summarise_all(funs(n_distinct(.))) %>%
kable(booktabs = TRUE,format = "latex", caption = "\\label{tabla6}Presentación Datos únicos en cada columna de la tabla original segunda parte") %>%
kable_styling( latex_options = c("striped", "condensed","hold_position","scale_down"), position="left")
glimpse(Estud) # visualizando la estructura original
Estud$Puntaje[Estud$Puntaje == 0] <-32 #reemplazamos un valor cero por un promedio del atriburo puntaje
DEstudia<-data.frame(ID=(Estud$ID),Sexo=Estud$Sexo,Edad=round(as.numeric(Estud$Edad)),Fuma=Estud$Fuma,               Estatura=Estud$Estatura,Colegio=Estud$Colegio,Estrato=round(as.numeric(Estud$Estrato)),
Financiacion=Estud$Financiacion,Acumulado=(as.numeric(Estud$Acumulado)),
Gastos=round(as.integer(Estud$Gastos)),                    Ingreso=(as.numeric(Estud$Ingreso)),Clases=Estud$Clases,Pandemia=Estud$Pandemia,                     Clases_virtuales=Estud$Clases_virtuales,Estadistica=Estud$Estadistica,                     Inseguridad=(as.character(Estud$inseguridad)),vida_cotidiana=Estud$vida_cotidiana,Puntaje=round(Estud$Puntaje))
glimpse(DEstudia)# usando glimpse para ver sus estructura
names(DEstudia)
Estuvar<-DEstudia[,c("Sexo","Colegio","Estrato","Financiacion","Clases","Edad","Ingreso","Puntaje")]
head(Estuvar,3) %>%
kable(booktabs = TRUE,format = "latex", caption = "\\label{tabla6}Presentación de las columnas a Trabajar") %>%
kable_styling( latex_options = c("striped", "condensed","hold_position","scale_down"), position="left")
summary(Estuvar)# suamrio general de las variables de al tabla Estuvar
colnam<-c("Financiacion","Clases","Edad","Ingreso","Puntaje")
ggpairs(DEstudia, columns = colnam, aes(color = Estrato, alpha = 0.5),
upper = list(continuous = "points"))
par(mfrow = c(1, 2))
# Creamos un histograma
hist(Estuvar$Ingreso, freq = FALSE, main = "Densidad del Ingreso",
ylab = "Densidad", xlab = "Ingreso en Millon",col = "cyan", border = "blue")
boxplot(Estuvar$Ingreso ~ Estuvar$Estrato, main="Ingreso Social",xlab = "Estrato Social", ylab = "Salario en millones",col = "cyan", border = "blue")
par(mfrow = c(1, 2))
hist(Estuvar$Ingreso,
breaks = 4,
main = "Montos en Millones",
xlab = "Salario",
ylab = "Número de personas",
xlim = c(0,4),                      # rango de valores del eje x
col = "cyan",                        # color de relleno
border = "white",                     # color del borde del rectángulo
)
barplot(table(Estuvar$Sexo),xlab = "Genero", main = "Total por Género",ylab = "Cantidad Personas", col = "cyan", border = "white")
nconsul<- Estuvar %>% # consulta a la tabla Estuvar
select(Financiacion, Edad, Ingreso, Puntaje) %>%
group_by(Financiacion, Puntaje)
tabnconsul <- table(nconsul$Financiacion, nconsul$Puntaje, dnn = c("Financiacion","Puntaje"))
head(nconsul,4) %>%
kable(booktabs = TRUE,format = "latex", caption = "\\label{tabla7}Presentación de una consulta que nos filtra a través de una funcion table, cuya busqueda lo hace por un dnn que nos realiza mejor la búsqueda dentro de la tabla") %>%
kable_styling( latex_options = c("striped", "condensed","hold_position","scale_down"), position="center")
tab<-table(nconsul$Financiacion)
tab
par(mfrow = c(1, 3))
hist(nconsul$Puntaje[nconsul$Financiacion=="Beca"], main = "Financiación por Beca",xlab = "Rango Becados", col = "cyan")
hist(nconsul$Puntaje[nconsul$Financiacion=="Credito"], main = "Financiación por Crédito",xlab = "Rango Crédito", col = "cyan")
hist(nconsul$Puntaje[nconsul$Financiacion=="Otro"], main = "Financiación Otros medios",xlab = "Rango Otro", col = "cyan")
nconvar <- Estuvar %>%
select(Estrato,Financiacion,Clases,Colegio,Sexo) %>%
group_by(Estrato,Financiacion,Clases)
head(nconvar,4) %>%
kable(booktabs = TRUE,format = "latex", caption = "\\label{tabla8}Presentación de los datos cualitativos resuminda en una tabla y en consulta") %>%
kable_styling( latex_options = c("striped", "condensed","hold_position","scale_down"), position="center")
cat("RESUMENES GENERALES DE LAS VALRIABLES SELECCIONADAS")
cat("===================================================")
cat("Resumen Tabla de Variable Clases")
tabbl<-table(nconvar$Clases)
tabbl
cat("Resumen Tabla de Variable Estrato")
tabble<-table(nconvar$Estrato)
tabble
cat("Resumen Tabla de Variable Financiacion")
tabbles<-table(nconvar$Financiacion)
tabbles
cat("Resumen Tabla de Variable Colegiatura")
tabblcol<-table(nconvar$Colegio)
tabblcol
cat("Resumen Tabla de Variable Genero")
tabblgen<-table(nconvar$Sexo)
tabblgen
#library(lessR)
par(mfrow = c(2, 3))
barplot(tabbl,xlab = "Las Clases", main = "Las Clases",ylab = "Cantidad en Clases", col = "cyan", border = "white")
barplot(tabble,xlab = c("Bajo-Medio-Alto"), main = "Estrato Social",ylab = "Cantidad en Estratos", col = "cyan", border = "white")
barplot(tabbles,xlab = c("Beca-Crédito-Otros"), main = "Financiamiento",ylab = "Cantidad Financiados", col = "cyan", border = "white")
barplot(tabblcol,xlab = c("Privado-Publico"), main = "Establecimientos",ylab = "Cantidad Establecimientos", col = "cyan", border = "white")
barplot(tabblgen,xlab = c("Femenino-Masculino"), main = "Generos",ylab = "Cantidad por Género", col = "cyan", border = "white")
sumq<- Estuvar %>%
summarise(Atributo=c("Edad","Ingreso","Puntaje"),
Media=c(mean(Edad),mean(Ingreso),mean(Puntaje)),
Mediana= c(median(Edad),median(Ingreso),median(Puntaje)),
Desv_SD= c(sd(Edad),sd(Ingreso),sd(Puntaje)),
Q1= c(quantile(Edad, .25),quantile(Ingreso, .25),quantile(Puntaje, .25)),
Q2= c(quantile(Edad, .50),quantile(Ingreso, .50),quantile(Puntaje, .50)),
Q3= c(quantile(Edad, .75),quantile(Ingreso, .75),quantile(Puntaje, .75)),
Moda= c(mode(Edad),mode(Ingreso),mode(Puntaje)),
Min= c(min(Edad),min(Ingreso),min(Puntaje)),
Max= c(max(Edad),max(Ingreso),max(Puntaje)),
contar=n()
)
head(sumq) %>%
kable(booktabs = TRUE,format = "latex", caption = "\\label{tabla9}Datos Estadísticos de Variables cuantitativas Edad, Puntaje e Ingreso") %>%
kable_styling( latex_options = c("striped", "condensed","hold_position","scale_down"), position="left")
nrel<- Estuvar %>%
select(Edad, Ingreso,Financiacion) %>%
group_by(Edad, Ingreso)
#nrel
knitr::kable(head(nrel, 6))
#head(nrel) %>%
#  kable(booktabs = TRUE,format = "latex", caption = "\\label{tabla10}Datos Estadisticos de Variables cuantitativas Edad, #Ingreso, Financiacion") %>%
#  kable_styling( latex_options = c("striped", "condensed","hold_position","scale_down"), position="left")
tabrel <- table(nrel$Edad, nrel$Ingreso, dnn = c("Edad","Ingreso"))
cat("Resumen Tabla de Variable Clases\n")
cat("================================\n")
tabbl<-table(tabrel)
tabbl
ggplot(data=nrel, mapping = aes(x=Edad), y=Ingreso) +
geom_bar(color="cyan")+
geom_vline(aes(xintercept=mean(Edad)),color="blue", linetype="dashed", size=1)+
geom_vline(aes(xintercept=median(Edad)),color="red", linetype="dashed", size=1)+
labs(x="Edad",y="Cantidad Personas",title ="Relacion entre la edad y el monto del salario persibido con respecto a la edad", subtitle = "Por Edades", caption = "Sueldo en millones")
ggplot(data = nrel, aes(x=Edad, y=Ingreso, group=Financiacion))+
geom_point(aes(color=Financiacion))+
geom_hline(aes(yintercept = mean(Ingreso), colour = "red"))+
geom_vline(aes(xintercept=mean(Edad)),color="blue", linetype="dashed", size=1)+
#geom_vline(aes(xintercept=median(Edad)),color="red", linetype="dashed", size=1)+
facet_grid(~Financiacion)+
labs(x="",y="",title ="Relacion entre la edad y el monto del salario persibido por edad", subtitle = "Por Financiamiento", caption = "Sueldo en millones")+
theme(legend.position = "bottom")+theme_bw()
ggplot(data = nrel, aes(x=Edad, y=Ingreso, group=Financiacion))+
geom_boxplot(aes(color=Financiacion))+
geom_hline(aes(yintercept = median(Ingreso), colour = "red"))+
facet_grid(~Financiacion)+
labs(x="",y="",title ="Relacion entre la edad y el monto del salario persibido por edad", subtitle = "Por Financiamiento en sus 3 categorías", caption = "Sueldo en millones")+
theme(legend.position = "bottom")+theme_bw()
ggplot(nrel, aes(nrel$Edad,nrel$Ingreso)) +
geom_point() +
geom_vline(aes(xintercept=median(Edad)),color="red", linetype="dashed", size=1)+
geom_hline(aes(yintercept = median(Ingreso), colour = "red"))+
labs(x="Edad General",y="Ingreso por Monto",title ="Diagrama Dispersion entre Edad e Ingreso", subtitle = "Por masa de Puntos",
caption = "Sueldo en millones por edades")
#names(nrel)
chart.Correlation(nrel[,0:2], histogram = TRUE)
cat("Test de Calculó de satisfacción en correlación \n")
cat("==============================================")
cor.test(nrel$Edad,nrel$Ingreso)
nrelfreq<- Estuvar %>%
select(Clases,Financiacion) %>%
group_by(Clases,Financiacion)
cat("Tabla de Frecuencia Generada por consulta\n")
cat("=========================================\n")
tabrelfreq <- table(nrelfreq$Clases, nrelfreq$Financiacion, dnn = c("Clases","Financiacion"))
cat("\n")
cat("Creacion tabla frecuencia en orden\n")
cat("==================================\n")
tabblfreq<-table(tabrelfreq)
tabblfreq
cat("\n")
cat("I Construya una tabla de frecuencia o tabla de contingencia con  Financiacion y Clase\n")
cat("=======================================================================================\n")
table(nrelfreq$Financiacion) #tabla de frecuencia para Financiacion
cat("\n")
cat("I.I Tabla de frecuencia por clases\n")
cat("==================================\n")
table(nrelfreq$Clases) #tabla de frecuencia para Clases
cat("\n")
cat("I.II Tabla de contingencia entre Financiacion y Clases\n")
cat("=========================================================")
table(nrelfreq$Financiacion, nrelfreq$Clases) #tabla de contingencia entre Financiacion y Clases
# Valores que se obtuvieron en las tablas
P2_2<-54/(285+115)
cat('Resultado de elegir un estudiante al azar es :', P2_2)
P2_3<-81/285
cat("La Probabilidad que tenga beca es : ",P2_3)
P4_B<-0.36*0.02+0.31*0.03+0.33*0.05
cat("La Probabilidad que tenga problema con el pago es : ",P4_B)
P4_C<-(0.33*0.05)/P4_B
cat("La Probabilidad que tenga beca con el problema del pago es : ",P4_C)
prop.table(table(Estud$Fuma))*100
DEstudents <- read_csv("DEstudents.csv",
col_types = cols(Estrato = col_character()))
p<-as.numeric(count(DEstudents[DEstudents$Fuma == "Si", "Fuma"])/count(DEstudents[DEstudents$Fuma, "Fuma"]))
n<-25
k<-10
#dbinom(k,n,p)
cat("La Probabilidad que 10 ellos si fuma es : ",dbinom(k,n,p))
n<-30
k<-15
#pbinom(k, n, p)
cat("La Probabilidad  que a lo más 15 de ellos si fuma es : ",pbinom(k, n, p))
E<-round(n*(1-p))
cat("El número esperado de estudiante que no fuma es :",E, " Alumnos" )
s <- DEstudents %>%
summarize(media = mean(DEstudents$Ingreso), deviacion_standar = sd(DEstudents$Ingreso))
s
pn<-pnorm(1.5,mean(DEstudents$Ingreso),sd(DEstudents$Ingreso))
cat("La probabilidad de que el ingreso sea a lo más de $1.500.000 es: ", pn)
pi<-1-pnorm(1,mean(DEstudents$Ingreso),sd(DEstudents$Ingreso))
cat("probabilidad de que el ingreso sea de más de $1.000.000 es:",pi)
if(!require(knitr)) { install.packages("knitr"); library(knitr) } # trabajos proyecto y tablas
if(!require(readxl)) { install.packages("readxl"); library(readxl) } # lectura de archivo xlsx
if(!require(stringr)) { install.packages("stringr"); library(stringr) } # reconocimientos strigr
if(!require(readr)) { install.packages("readr"); library(readr) } # lectura de documento csv
if(!require(dplyr)) { install.packages("readr"); library(dplyr) } # paquete consulta tablas
if(!require(kableExtra)) { install.packages("kableExtra"); library(kableExtra) } # librería  de tablas
if(!require(ggplot2)) { install.packages("ggplot2"); library(ggplot2) } #paquetes de gráficos
if(!require(GGally)) { install.packages("GGally"); library(GGally) } # libreria para gráficos
if(!require(PerformanceAnalytics)) { install.packages("PerformanceAnalytics"); library(PerformanceAnalytics) }
library(knitr)
library(RColorBrewer)
library(ggplot2)
library(proto)
library(dplyr)
library(kableExtra)
library(readr)
library(readxl)
library(GGally)
library(RColorBrewer) # colores de gráficos
library(PerformanceAnalytics)
# carga de la datasets Estudiantes
Estud <- read_excel("C:/Users/salop/OneDrive/Escritorio/EnvR/MagisterUdla/AnalisisEstadistico_Viviam_Salomon/Estudiantes.xlsx") #cargamos la data xlsx
Estud<-Estud[100:249,] #cantidad seleccionada para la muestra es 150 datos
Estud<-data.frame(Estud) # la convertimos en dataframe
Estudi<-Estud[,c("ID","Sexo","Edad","Fuma","Estatura","Colegio","Estrato")] # seleccionamos las tablas
head(Estudi,3) %>%
kable(booktabs = TRUE,format = "latex", caption = "\\label{tabla2}Presentación Primera Mitad tabla Actual a Trabajar") %>%
kable_styling( latex_options = c("striped", "condensed","hold_position","scale_down"), position="left")
Estudi2<-Estud[,c("Financiacion","Acumulado","Gastos","Ingreso","Clases","Pandemia")] #selección de campos
head(Estudi2,3) %>%
kable(booktabs = TRUE,format = "latex", caption = "\\label{tabla3}Presentación Segunda Mitad tabla Actual a Trabajar") %>%
kable_styling( latex_options = c("striped", "condensed","hold_position","scale_down"), position="left")
Estudi3<-Estud[,c("Clases_virtuales","Estadistica","inseguridad","vida_cotidiana","Puntaje")]
head(Estudi3,6) %>%
kable(booktabs = TRUE,format = "latex", caption = "\\label{tabla4}Presentación Tercera Mitad tabla Actual a Trabajar") %>%
kable_styling( latex_options = c("striped", "condensed","hold_position","scale_down"), position="left")
apply(X = is.na(Estud), MARGIN = 2, FUN = sum)
Estudiuni<-Estud[,c("ID","Sexo","Edad","Fuma","Estatura","Colegio","Estrato","Financiacion","Acumulado","Gastos")]
Estudiuni %>% summarise_all(funs(n_distinct(.))) %>%
kable(booktabs = TRUE,format = "latex", caption = "\\label{tabla5}Presentación valores unicos de la tabla original priemra parte") %>%
kable_styling( latex_options = c("striped", "condensed","hold_position","scale_down"), position="left")
Estudiuni2<-Estud[,c("Ingreso","Clases","Pandemia","Clases_virtuales","Estadistica","inseguridad","vida_cotidiana","Puntaje")]
Estudiuni2 %>% summarise_all(funs(n_distinct(.))) %>%
kable(booktabs = TRUE,format = "latex", caption = "\\label{tabla6}Presentación Datos únicos en cada columna de la tabla original segunda parte") %>%
kable_styling( latex_options = c("striped", "condensed","hold_position","scale_down"), position="left")
glimpse(Estud) # visualizando la estructura original
Estud$Puntaje[Estud$Puntaje == 0] <-32 #reemplazamos un valor cero por un promedio del atriburo puntaje
DEstudia<-data.frame(ID=(Estud$ID),Sexo=Estud$Sexo,Edad=round(as.numeric(Estud$Edad)),Fuma=Estud$Fuma,               Estatura=Estud$Estatura,Colegio=Estud$Colegio,Estrato=round(as.numeric(Estud$Estrato)),
Financiacion=Estud$Financiacion,Acumulado=(as.numeric(Estud$Acumulado)),
Gastos=round(as.integer(Estud$Gastos)),                    Ingreso=(as.numeric(Estud$Ingreso)),Clases=Estud$Clases,Pandemia=Estud$Pandemia,                     Clases_virtuales=Estud$Clases_virtuales,Estadistica=Estud$Estadistica,                     Inseguridad=(as.character(Estud$inseguridad)),vida_cotidiana=Estud$vida_cotidiana,Puntaje=round(Estud$Puntaje))
glimpse(DEstudia)# usando glimpse para ver sus estructura
names(DEstudia)
Estuvar<-DEstudia[,c("Sexo","Colegio","Estrato","Financiacion","Clases","Edad","Ingreso","Puntaje")]
head(Estuvar,3) %>%
kable(booktabs = TRUE,format = "latex", caption = "\\label{tabla6}Presentación de las columnas a Trabajar") %>%
kable_styling( latex_options = c("striped", "condensed","hold_position","scale_down"), position="left")
summary(Estuvar)# suamrio general de las variables de al tabla Estuvar
colnam<-c("Financiacion","Clases","Edad","Ingreso","Puntaje")
ggpairs(DEstudia, columns = colnam, aes(color = Estrato, alpha = 0.5),
upper = list(continuous = "points"))
par(mfrow = c(1, 2))
# Creamos un histograma
hist(Estuvar$Ingreso, freq = FALSE, main = "Densidad del Ingreso",
ylab = "Densidad", xlab = "Ingreso en Millon",col = "cyan", border = "blue")
boxplot(Estuvar$Ingreso ~ Estuvar$Estrato, main="Ingreso Social",xlab = "Estrato Social", ylab = "Salario en millones",col = "cyan", border = "blue")
par(mfrow = c(1, 2))
hist(Estuvar$Ingreso,
breaks = 4,
main = "Montos en Millones",
xlab = "Salario",
ylab = "Número de personas",
xlim = c(0,4),                      # rango de valores del eje x
col = "cyan",                        # color de relleno
border = "white",                     # color del borde del rectángulo
)
barplot(table(Estuvar$Sexo),xlab = "Genero", main = "Total por Género",ylab = "Cantidad Personas", col = "cyan", border = "white")
nconsul<- Estuvar %>% # consulta a la tabla Estuvar
select(Financiacion, Edad, Ingreso, Puntaje) %>%
group_by(Financiacion, Puntaje)
tabnconsul <- table(nconsul$Financiacion, nconsul$Puntaje, dnn = c("Financiacion","Puntaje"))
head(nconsul,4) %>%
kable(booktabs = TRUE,format = "latex", caption = "\\label{tabla7}Presentación de una consulta que nos filtra a través de una funcion table, cuya busqueda lo hace por un dnn que nos realiza mejor la búsqueda dentro de la tabla") %>%
kable_styling( latex_options = c("striped", "condensed","hold_position","scale_down"), position="center")
tab<-table(nconsul$Financiacion)
tab
par(mfrow = c(1, 3))
hist(nconsul$Puntaje[nconsul$Financiacion=="Beca"], main = "Financiación por Beca",xlab = "Rango Becados", col = "cyan")
hist(nconsul$Puntaje[nconsul$Financiacion=="Credito"], main = "Financiación por Crédito",xlab = "Rango Crédito", col = "cyan")
hist(nconsul$Puntaje[nconsul$Financiacion=="Otro"], main = "Financiación Otros medios",xlab = "Rango Otro", col = "cyan")
nconvar <- Estuvar %>%
select(Estrato,Financiacion,Clases,Colegio,Sexo) %>%
group_by(Estrato,Financiacion,Clases)
head(nconvar,4) %>%
kable(booktabs = TRUE,format = "latex", caption = "\\label{tabla8}Presentación de los datos cualitativos resuminda en una tabla y en consulta") %>%
kable_styling( latex_options = c("striped", "condensed","hold_position","scale_down"), position="center")
cat("RESUMENES GENERALES DE LAS VALRIABLES SELECCIONADAS")
cat("===================================================")
cat("Resumen Tabla de Variable Clases")
tabbl<-table(nconvar$Clases)
tabbl
cat("Resumen Tabla de Variable Estrato")
tabble<-table(nconvar$Estrato)
tabble
cat("Resumen Tabla de Variable Financiacion")
tabbles<-table(nconvar$Financiacion)
tabbles
cat("Resumen Tabla de Variable Colegiatura")
tabblcol<-table(nconvar$Colegio)
tabblcol
cat("Resumen Tabla de Variable Genero")
tabblgen<-table(nconvar$Sexo)
tabblgen
#library(lessR)
par(mfrow = c(2, 3))
barplot(tabbl,xlab = "Las Clases", main = "Las Clases",ylab = "Cantidad en Clases", col = "cyan", border = "white")
barplot(tabble,xlab = c("Bajo-Medio-Alto"), main = "Estrato Social",ylab = "Cantidad en Estratos", col = "cyan", border = "white")
barplot(tabbles,xlab = c("Beca-Crédito-Otros"), main = "Financiamiento",ylab = "Cantidad Financiados", col = "cyan", border = "white")
barplot(tabblcol,xlab = c("Privado-Publico"), main = "Establecimientos",ylab = "Cantidad Establecimientos", col = "cyan", border = "white")
barplot(tabblgen,xlab = c("Femenino-Masculino"), main = "Generos",ylab = "Cantidad por Género", col = "cyan", border = "white")
sumq<- Estuvar %>%
summarise(Atributo=c("Edad","Ingreso","Puntaje"),
Media=c(mean(Edad),mean(Ingreso),mean(Puntaje)),
Mediana= c(median(Edad),median(Ingreso),median(Puntaje)),
Desv_SD= c(sd(Edad),sd(Ingreso),sd(Puntaje)),
Q1= c(quantile(Edad, .25),quantile(Ingreso, .25),quantile(Puntaje, .25)),
Q2= c(quantile(Edad, .50),quantile(Ingreso, .50),quantile(Puntaje, .50)),
Q3= c(quantile(Edad, .75),quantile(Ingreso, .75),quantile(Puntaje, .75)),
Moda= c(mode(Edad),mode(Ingreso),mode(Puntaje)),
Min= c(min(Edad),min(Ingreso),min(Puntaje)),
Max= c(max(Edad),max(Ingreso),max(Puntaje)),
contar=n()
)
head(sumq) %>%
kable(booktabs = TRUE,format = "latex", caption = "\\label{tabla9}Datos Estadísticos de Variables cuantitativas Edad, Puntaje e Ingreso") %>%
kable_styling( latex_options = c("striped", "condensed","hold_position","scale_down"), position="left")
nrel<- Estuvar %>%
select(Edad, Ingreso,Financiacion) %>%
group_by(Edad, Ingreso)
#nrel
knitr::kable(head(nrel, 6))
#head(nrel) %>%
#  kable(booktabs = TRUE,format = "latex", caption = "\\label{tabla10}Datos Estadisticos de Variables cuantitativas Edad, #Ingreso, Financiacion") %>%
#  kable_styling( latex_options = c("striped", "condensed","hold_position","scale_down"), position="left")
tabrel <- table(nrel$Edad, nrel$Ingreso, dnn = c("Edad","Ingreso"))
cat("Resumen Tabla de Variable Clases\n")
cat("================================\n")
tabbl<-table(tabrel)
tabbl
ggplot(data=nrel, mapping = aes(x=Edad), y=Ingreso) +
geom_bar(color="cyan")+
geom_vline(aes(xintercept=mean(Edad)),color="blue", linetype="dashed", size=1)+
geom_vline(aes(xintercept=median(Edad)),color="red", linetype="dashed", size=1)+
labs(x="Edad",y="Cantidad Personas",title ="Relacion entre la edad y el monto del salario persibido con respecto a la edad", subtitle = "Por Edades", caption = "Sueldo en millones")
ggplot(data = nrel, aes(x=Edad, y=Ingreso, group=Financiacion))+
geom_point(aes(color=Financiacion))+
geom_hline(aes(yintercept = mean(Ingreso), colour = "red"))+
geom_vline(aes(xintercept=mean(Edad)),color="blue", linetype="dashed", size=1)+
#geom_vline(aes(xintercept=median(Edad)),color="red", linetype="dashed", size=1)+
facet_grid(~Financiacion)+
labs(x="",y="",title ="Relacion entre la edad y el monto del salario persibido por edad", subtitle = "Por Financiamiento", caption = "Sueldo en millones")+
theme(legend.position = "bottom")+theme_bw()
ggplot(data = nrel, aes(x=Edad, y=Ingreso, group=Financiacion))+
geom_boxplot(aes(color=Financiacion))+
geom_hline(aes(yintercept = median(Ingreso), colour = "red"))+
facet_grid(~Financiacion)+
labs(x="",y="",title ="Relacion entre la edad y el monto del salario persibido por edad", subtitle = "Por Financiamiento en sus 3 categorías", caption = "Sueldo en millones")+
theme(legend.position = "bottom")+theme_bw()
ggplot(nrel, aes(nrel$Edad,nrel$Ingreso)) +
geom_point() +
geom_vline(aes(xintercept=median(Edad)),color="red", linetype="dashed", size=1)+
geom_hline(aes(yintercept = median(Ingreso), colour = "red"))+
labs(x="Edad General",y="Ingreso por Monto",title ="Diagrama Dispersion entre Edad e Ingreso", subtitle = "Por masa de Puntos",
caption = "Sueldo en millones por edades")
#names(nrel)
chart.Correlation(nrel[,0:2], histogram = TRUE)
cat("Test de Calculó de satisfacción en correlación \n")
cat("==============================================")
cor.test(nrel$Edad,nrel$Ingreso)
nrelfreq<- Estuvar %>%
select(Clases,Financiacion) %>%
group_by(Clases,Financiacion)
cat("Tabla de Frecuencia Generada por consulta\n")
cat("=========================================\n")
tabrelfreq <- table(nrelfreq$Clases, nrelfreq$Financiacion, dnn = c("Clases","Financiacion"))
cat("\n")
cat("Creacion tabla frecuencia en orden\n")
cat("==================================\n")
tabblfreq<-table(tabrelfreq)
tabblfreq
cat("\n")
cat("I Construya una tabla de frecuencia o tabla de contingencia con  Financiacion y Clase\n")
cat("=======================================================================================\n")
table(nrelfreq$Financiacion) #tabla de frecuencia para Financiacion
cat("\n")
cat("I.I Tabla de frecuencia por clases\n")
cat("==================================\n")
table(nrelfreq$Clases) #tabla de frecuencia para Clases
cat("\n")
cat("I.II Tabla de contingencia entre Financiacion y Clases\n")
cat("=========================================================")
table(nrelfreq$Financiacion, nrelfreq$Clases) #tabla de contingencia entre Financiacion y Clases
# Valores que se obtuvieron en las tablas
P2_2<-54/(285+115)
cat('Resultado de elegir un estudiante al azar es :', P2_2)
P2_3<-81/285
cat("La Probabilidad que tenga beca es : ",P2_3)
P4_B<-0.36*0.02+0.31*0.03+0.33*0.05
cat("La Probabilidad que tenga problema con el pago es : ",P4_B)
P4_C<-(0.33*0.05)/P4_B
cat("La Probabilidad que tenga beca con el problema del pago es : ",P4_C)
prop.table(table(Estud$Fuma))*100
DEstudents <- read_csv("DEstudents.csv",
col_types = cols(Estrato = col_character()))
p<-as.numeric(count(DEstudents[DEstudents$Fuma == "Si", "Fuma"])/count(DEstudents[DEstudents$Fuma, "Fuma"]))
n<-25
k<-10
#dbinom(k,n,p)
cat("La Probabilidad que 10 ellos si fuma es : ",dbinom(k,n,p))
n<-30
k<-15
#pbinom(k, n, p)
cat("La Probabilidad  que a lo más 15 de ellos si fuma es : ",pbinom(k, n, p))
E<-round(n*(1-p))
cat("El número esperado de estudiante que no fuma es :",E, " Alumnos" )
s <- DEstudents %>%
summarize(media = mean(DEstudents$Ingreso), deviacion_standar = sd(DEstudents$Ingreso))
s
pn<-pnorm(1.5,mean(DEstudents$Ingreso),sd(DEstudents$Ingreso))
cat("La probabilidad de que el ingreso sea a lo más de $1.500.000 es: ", pn)
pi<-1-pnorm(1,mean(DEstudents$Ingreso),sd(DEstudents$Ingreso))
cat("probabilidad de que el ingreso sea de más de $1.000.000 es:",pi)
